---
layout: post
title: Location Pickers With Angularjs
demo: http://winkervsbecks.github.io/the-core
source: https://github.com/winkerVSbecks/the-core
---

<p data-height="600" data-theme-id="7569" data-slug-hash="4d0c2a06e9671ec046baf30a16d811a8" data-default-tab="result" data-user="winkerVSbecks" class='codepen'>See the Pen <a href='http://codepen.io/winkerVSbecks/pen/4d0c2a06e9671ec046baf30a16d811a8/'>4d0c2a06e9671ec046baf30a16d811a8</a> by Varun Vachhar (<a href='http://codepen.io/winkerVSbecks'>@winkerVSbecks</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
<script async src="//codepen.io/assets/embed/ei.js"></script>

{% include demo-source.html %}

There are two ways we can capture the user's location: fetch nearby locations based on the GPS data or allow the user to query the location database manually.

For the first method we need to grab the GPS data for the user. You can get this using the `navigator.geolocation.getCurrentPosition` and it works for both browsers and Cordova/PhoneGap.

In all there are five parts to this process:

### Location
A service which checks to see if geo-location is available and grabs the current location. It also allows us to register *on-ready-tasks* with it. Therefore, all the other directives/services which depend on the geo-location data only bootstrap once the data is available.

### Reverse Geocoder
Reverse geocoding is the process of converting geographic coordinates (like latitude 37.423021 and longitude -122.083739) into a human-readable address (like 1600 Amphitheatre Parkway, Mountain View, CA).

This service sets up the Google Geocoder service and uses the GPS data to fetch, reverse geocoded, nearby locations. The service provides various options with reducing resolution, for example:

- House #, Street, City, Province, Postal Code, Country
- Street, City, Province, Postal Code, Country
- City, Province, Postal Code, Country
- Neighbourhood, City, Province, Country
- City, Province, Postal Code, Country

### Location-Picker
While latitude and longitude provide the physical location it helps to give the user a bit more context such as the human-readable address or a description of the place.

`Location-Picker` utilizes the `reverse-geocoder` service to fetch a few options for the user. The user selection is then bound to the object passed in through the `ng-model` attribute.

{% highlight html %}
<!-- Requires access to the user's GPS -->
<location-lookup
    ng-model="lookedUpLocation"
    limit-to="4"></location-lookup>
{% endhighlight %}

### Location-Predictions
It's a directive that generates a search box and sets up the Google Auto-complete service. The auto-complete service fetches predictions based on the user entered query string.

### Location-Lookup
This directive uses the `predictions` service to display a list of locations for the user to pick from. Once the user picks a location it uses the Google Places service to fetch the geo-location data for it.

{% highlight html %}
<!-- Requires user to enter a query -->
<location-picker
    ng-model="pickedLocation"
    limit-to="5"></location-picker>
{% endhighlight %}

The directives are fairly straight forward to use. They essentially behave as a `<select>`. The selection is captured using `ng-model`. Optionally you can limit the number of choices by using the `limit-to` attribute.

The selection returns the following data:

{% highlight html %}
{
    name: 'Mountain View',
    description: 'Mountain View, CA, United States',
    latitude: 37.3860517,
    longitude: -122.0838511
}
{% endhighlight %}